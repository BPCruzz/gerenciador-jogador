<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Time</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="padding: 20px;">

<div class="container">
    <a href="/times.html">&larr; Voltar para a lista</a>

    <h1 class="mt-3">Adicionar Novo Time</h1>
    <hr>

    <form id="form-time">

        <div class="mb-3">
            <label for="nome" class="form-label">Nome do Time:</label>
            <input type="text" class="form-control" id="nome" required>
        </div>

        <div class="mb-3">
            <label for="nomeEstadio" class="form-label">Nome do Estádio:</label>
            <input type="text" class="form-control" id="nomeEstadio" required>
        </div>

        <hr>
        <button type"submit" class="btn btn-success">Salvar Time</button>
    </form>
</div>

<script>
    // 2. Esta função será chamada quando o formulário for enviado
    async function salvarTime(event) {
        // Previne o recarregamento da página (comportamento padrão do form)
        event.preventDefault();

        // 3. Monta o objeto JSON com os dados do formulário
        const dadosDoTime = {
            nome: document.getElementById('nome').value,
            nomeEstadio: document.getElementById('nomeEstadio').value
        };

        console.log("Enviando para o backend:", JSON.stringify(dadosDoTime));

        // 4. Envia o POST para o backend
        try {
            const response = await fetch('/times', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(dadosDoTime),
            });

            if (response.ok) {
                alert('Time salvo com sucesso!');
                // 5. Volta para a página da lista de times
                window.location.href = '/times.html';
            } else {
                alert('Erro ao salvar time.');
            }
        } catch (error) {
            console.error("Erro no fetch:", error);
            alert('Erro de comunicação com o servidor.');
        }
    }

    // 6. "Escuta" o clique no botão Salvar (submit)
    const form = document.getElementById('form-time');
    form.addEventListener('submit', salvarTime);
</script>
</body>
</html>