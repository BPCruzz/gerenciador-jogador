<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciar Times</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body style="padding: 20px;">

<div class="container">
    <a href="/">&larr; Voltar para a Página Inicial</a>

    <h1 class="mt-3">Gerenciar Times</h1>

    <hr>

    <h2>Times Cadastrados:</h2>
    <div id="lista-de-times">
    </div>
</div>

<script>
    // 3. Esta função busca os dados da nossa API

    async function buscarTimes() {
        console.log("Buscando times");

        const response = await fetch('/times'); // Chama o GET /times
        const times = await response.json();

        console.log("Dados recebidos:", times);

        // 4. Esta função vai construir o HTML da lista
        mostrarTimesNaTela(times);
    }

    // 5. Esta função pega os dados (JSON) e transforma em HTML
    function mostrarTimesNaTela(times) {
        const container = document.getElementById('lista-de-times');
        container.innerHTML = ''; // Limpa a lista antes de adicionar

        // 6. Cria uma tabela do Bootstrap para ficar bonito
        const table = document.createElement('table');
        table.className = 'table table-striped';

        // 7. Cabeçalho da tabela
        table.innerHTML = `
            <thead class="table-dark">
                <tr>
                    <th>ID</th>
                    <th>Nome do Time</th>
                    <th>Estádio</th>
                    <th>Ações</th>
                </tr>
            </thead>
        `;

        // 8. Corpo da tabela
        const tbody = document.createElement('tbody');
        times.forEach(time => {
            // Cria uma linha <tr> para cada time
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${time.id}</td>
                <td>${time.nome}</td>
                <td>${time.nomeEstadio}</td>
               <td><a href="/jogadores.html?timeId=${time.id}&timeNome=${time.nome}" class="btn btn-info btn-sm">Ver Jogadores</a>
            `;
            tbody.appendChild(tr);
        });

        table.appendChild(tbody);
        container.appendChild(table);
    }

    // 9. Roda a função de buscar assim que a página carregar
    window.onload = buscarTimes;

</script>
</body>
</html>